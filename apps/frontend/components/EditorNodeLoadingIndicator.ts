import { setTestId } from '../utils/dom/testId';

type TOptions = {
  id: string;
  text: string | undefined;
};

type TReturnEditorNodeLoadingIndicator = {
  element: HTMLDivElement;
};

const EditorNodeLoadingIndicator = (
  opts: TOptions,
): TReturnEditorNodeLoadingIndicator => {
  const indicatorDiv = document.createElement('div');
  const animatedSvgDiv = document.createElement('div');
  const textDiv = document.createElement('div');

  indicatorDiv.classList.add('editor-node-loading-indicator');
  animatedSvgDiv.classList.add('editor-node-loading-indicator__animated-svg');
  textDiv.classList.add('editor-node-loading-indicator__text');

  animatedSvgDiv.innerHTML = `<svg xmlns="http://www.w3.org/2000/svg" width="64" height="64" viewBox="0 0 64 64" fill="none">
    <path fill-rule="evenodd" clip-rule="evenodd" d="M34.0012 47.9934V48.0473L34.0257 48.0473L34.0012 48.0748L34.0013 63.9385C33.3396 63.9793 32.6724 64 32.0003 64C31.3283 64 30.6611 63.9793 29.9993 63.9385L29.9995 52.5614L29.2563 53.3848C26.2261 56.7342 23.8061 59.3139 21.9962 61.1238L21.7581 61.3609L21.4584 61.6566L21.2484 61.8618L21.0322 62.0711C19.605 61.5513 18.2255 60.9323 16.9016 60.2229L17.2474 59.9624C19.1851 58.4982 20.7472 57.2366 21.9339 56.1774L22.1565 55.9772L22.4261 55.7307L22.697 55.4794L22.9272 55.2631C23.4737 54.7472 24.0849 54.1519 24.761 53.4773L25.0751 53.1628C26.4599 51.7719 28.1014 50.0668 29.9995 48.0473V47.9934H34.0012ZM44.7238 41.8944L44.7619 41.9325L44.7792 41.9152L44.7813 41.952L56.0015 53.172C55.6728 53.5442 55.3356 53.9086 54.9901 54.265L54.2786 54.9765C53.9175 55.3265 53.5482 55.6681 53.171 56.0009L45.1242 47.954L45.1809 49.0619L45.2338 50.144L45.2783 51.1002L45.314 51.9074C45.4511 55.0866 45.5196 57.6734 45.5196 59.6678L45.5189 60.0038L45.517 60.321C45.5151 60.5611 45.512 60.7935 45.5078 61.0183C44.1481 61.653 42.7361 62.1941 41.2803 62.6343L41.3406 62.2055C41.6752 59.7994 41.8878 57.8025 41.9779 56.2142L41.9938 55.9152L42.0038 55.6987C42.1084 53.3256 42.0846 49.6801 41.9323 44.7621L41.8942 44.724L44.7238 41.8944ZM7.78667 41.9782L8.08565 41.994L8.45059 42.0103L8.7445 42.0215L8.97777 42.0293C11.3455 42.1033 14.7658 42.071 19.2387 41.9325L19.2769 41.8944L22.1065 44.724L22.0684 44.7621L22.0857 44.7795L22.0489 44.7816L10.8297 56.0009C10.4525 55.6681 10.0832 55.3265 9.72209 54.9765L9.01054 54.265C8.66509 53.9086 8.32786 53.5442 7.99915 53.172L16.0468 45.1245L14.939 45.1811C10.4805 45.4043 6.97504 45.5172 4.42276 45.5198L3.99705 45.5191L3.57606 45.5163L3.28245 45.5129L2.975 45.5079C2.33954 44.1478 1.79752 42.7354 1.35649 41.279L1.92739 41.359C4.27462 41.6832 6.22752 41.8896 7.78667 41.9782ZM48.0471 29.9752L48.0746 29.9997L63.9529 29.9995C63.9746 30.3541 63.9906 30.7103 64.0007 31.068V32.9055C63.9903 33.2724 63.9738 33.6378 63.9512 34.0015L52.5612 34.0014L53.3846 34.7446L54.1872 35.4724L54.9016 36.1233C57.5231 38.5178 59.5971 40.4782 61.1236 42.0047L61.3607 42.2428C61.6125 42.4966 61.8514 42.7407 62.0772 42.9752C61.5565 44.402 60.9366 45.781 60.2264 47.1043L59.9656 46.7581C58.5 44.8183 57.2373 43.2546 56.1772 42.0669L55.977 41.8444L55.831 41.6841L55.6338 41.47L55.4796 41.3043C53.8589 39.5697 51.3814 37.1353 48.0471 34.0014H47.9932V29.9997H48.0471L48.0471 29.9752ZM7.82344 21.9341L8.02368 22.1567L8.21959 22.3714L8.41891 22.5871L8.63662 22.8201C9.15659 23.3734 9.76054 23.9953 10.4485 24.6858L10.6864 24.924L11.1219 25.3571L11.4933 25.7238C12.7539 26.9644 14.2407 28.3898 15.9535 29.9997H16.0075V34.0014H15.9536L15.9535 34.0259L15.9261 34.0014L0.0494404 34.0015C0.0268532 33.6378 0.01034 33.2724 0 32.9055V31.068C0.0100797 30.7103 0.0260254 30.3541 0.0477457 29.9995L11.4395 29.9997L10.6161 29.2565C7.3056 26.2616 4.74709 23.8627 2.94051 22.0598L2.63993 21.7583L2.49054 21.6073L2.27657 21.3896L2.0937 21.2019C2.0336 21.14 1.97438 21.0788 1.91603 21.0182C2.43628 19.5902 3.05574 18.2098 3.76568 16.8853L4.11321 17.3463C5.54561 19.2384 6.78228 20.7676 7.82344 21.9341ZM53.1857 7.98568C53.3822 8.15925 53.5766 8.33519 53.7687 8.51347L55.4736 10.2183C55.6563 10.4153 55.8366 10.6146 56.0144 10.8161L47.9538 18.8766L49.0616 18.8199C53.5726 18.5942 57.108 18.4813 59.6676 18.4813L60.0036 18.4819L60.3208 18.4839L60.5213 18.4858L60.7833 18.4891C60.8695 18.4904 60.9547 18.4918 61.0388 18.4934C61.6727 19.854 62.2133 21.2668 62.6529 22.7234L62.3651 22.6828C59.8875 22.3351 57.8373 22.1151 56.214 22.0229L55.915 22.0071L55.6985 21.997L55.5059 21.9889L55.2069 21.9778C54.3932 21.9498 53.4493 21.935 52.375 21.9333L52.035 21.9332L51.4233 21.9351L50.9037 21.9385C49.143 21.9529 47.0957 21.9963 44.7619 22.0686L44.7238 22.1067L41.8942 19.2771L41.9323 19.239L41.915 19.2216L41.9517 19.2195L53.1857 7.98568ZM22.0227 7.78689L22.0069 8.08586L21.9936 8.37619L21.9858 8.5705L21.975 8.8721C21.949 9.65842 21.9351 10.564 21.9331 11.5888L21.933 11.9254C21.9343 13.9294 21.9794 16.3672 22.0683 19.239L22.1065 19.2771L19.2769 22.1067L19.2388 22.0686L19.2214 22.0859L19.2193 22.0491L7.98621 10.8161C8.16401 10.6146 8.34431 10.4153 8.52706 10.2183L10.2319 8.51347C10.4241 8.33519 10.6184 8.15925 10.8149 7.98568L18.8764 16.047L18.8197 14.9392L18.7668 13.8571L18.7153 12.7437C18.5613 9.31406 18.4833 6.54049 18.4811 4.42297L18.4817 3.99726L18.4829 3.78485C18.4848 3.49745 18.4883 3.22077 18.4934 2.95481C19.8542 2.31979 21.2675 1.77831 22.7246 1.3379C22.3526 3.94958 22.1185 6.09896 22.0227 7.78689ZM33.3153 0C33.5446 0.00926464 33.7733 0.0209413 34.0013 0.0350056L34.0011 11.4397L34.7444 10.6163C37.7745 7.26687 40.1945 4.6872 42.0045 2.87728L42.2425 2.64014L42.4682 2.41722L42.6113 2.27679L42.8963 1.99957C42.9275 1.96944 42.9585 1.93954 42.9893 1.90986C44.4168 2.43106 45.7966 3.0514 47.1206 3.76218L46.8881 3.93706C44.8879 5.44453 43.2809 6.73999 42.0667 7.82366L41.8441 8.02389L41.6839 8.16988L41.524 8.31691L41.3598 8.4693C39.6217 10.0888 37.1688 12.5836 34.0012 15.9538V16.0077H29.9995V15.9538L29.975 15.9538L29.9995 15.9263L29.9993 0.0350056C30.2274 0.0209413 30.4561 0.00926464 30.6854 0H33.3153Z" fill="#45484D"/>
  </svg>`;

  indicatorDiv.append(animatedSvgDiv, textDiv);

  if (opts.text !== undefined) {
    textDiv.textContent = opts.text;
  } else {
    textDiv.remove();
  }

  setTestId(indicatorDiv, opts.id);

  return {
    element: indicatorDiv,
  };
};

export type {
  TOptions as TEditorNodeLoadingIndicatorOptions,
  TReturnEditorNodeLoadingIndicator,
};

export { EditorNodeLoadingIndicator };
